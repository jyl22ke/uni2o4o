<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=0.6">
  <link rel="shortcut icon" href="#" type="image/x-icon">
  <link rel="icon" href="#" type="image/x-icon">
  <link rel="stylesheet" href="http://code.jquery.com/ui/1.10.3/themes/smoothness/jquery-ui.css" />        
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script> 
  <script src="http://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>      

  <style type="text/css">
	*{margin:0;padding:0px;list-style:none;text-decoration:none;}
	body{font-size:100%;}
	.container{max-width:678px; min-height: 950px;}
	.canvas {
		background: url(./bga.jpg) fixed;
		display:grid; 
		grid-template-columns: repeat(15,25px);
		padding: 20px;
		background-size:cover; 
		grid-gap: 0px;
		text-align:center;
		}
	.ifo {margin: 15px; font-size: 1.0em; height: 25px;}
	#nm,#nm0,#sjs,#nma,#nmb {font-size: 1.0em; font-weight:bold;width:60px;}
	#sj {font-size: 1.0em; font-weight:bold;width:150px;}
	.sjt {grid-column: 1/span 3;grid-row: 1/span 5; color: #000; font-weight: bold;border:1px solid black;}
	.sjo,.sjot {grid-column: span 3;grid-row: span 1; color: #000; font-weight: bold;border:1px solid black;height:30px;}
	.sj {grid-column: span 3;grid-row: span 1; color: #000; font-weight: bold;border:1px solid black;height:40px;font-size:2.0em; font-family:"한양해서";}
	.nmt {grid-column: span 3;grid-row: span 1; color: #000; font-weight: bold;border:1px solid black;height:70px;}
	.nm {grid-column: span 4;grid-row: span 1; color: #000; font-weight: bold;border:1px solid black;height:70px;font-size:4.0em; font-family:"한양해서";}
	.nmat {grid-column: span 3;grid-row: span 1; color: #000; font-weight: bold;border:1px solid black;height:30px;}
	.nma {grid-column: span 4;grid-row: span 1; color: #000; font-weight: bold;border:1px solid black;height:30px;}
	.nma0 {grid-column: span 4;grid-row: span 1; color: #000; font-weight: bold;border:1px solid black;height:30px;}
	.nma1 {grid-column: span 8;grid-row: span 1; color: #000; font-weight: bold;border:1px solid black;height:30px;}
	.nma2 {grid-column: span 12;grid-row: span 1; color: #000; font-weight: bold;border:1px solid black;height:30px;}
	.nmx {grid-column: span 4;grid-row: span 1; background: #999; font-weight: bold;border:1px solid black;height:30px;}
	#output {width:100%; min-height: 790px; color: #000; padding:10px; font-weight: bold;border:1px solid black;text-align:left;}
	#submit1 {padding: 0 10px; font-weight: bold;}
	#clear1 {padding: 0 5px;}
	@media screen and (min-width: 950px) { .container{width:100%;} .canvas {float: left;} #output {float: right;max-width:1360px;}}
  </style>
 </head>
 <body>

<!-- 메인메뉴 mmenu part -->
<div class="container">
	<div id="dvCSV"></div>    

<p class="ifo"> 사주: <input type="text" id="sj" maxlength="8" onchange='printSaju()'/>  성명: (한자) <input type="text" id="nm" size="10" onchange='printName()'/> (한글) <input type="text" id="nm0" size="10"> &nbsp; &nbsp;<button id="clear1">지우기</button> &nbsp; &nbsp;<button id="submit1">제 출</button></p> 
<p class="ifo"> (획수는 3개를 ","로 구분) &nbsp; (획수) <input type="text" id="nma"> (곡획) <input type="text" id="nmb"> &nbsp; 음령오행: <input type="text" id="sjs"> </p> 

<hr/>
	<div class="canvas">
		<div class="sjt">사주</div>
		<div class="sjot">시</div>
		<div class="sjot">일</div>
		<div class="sjot">월</div>
		<div class="sjot">년</div>
		<div class="sj" id="sj7"></div>
		<div class="sj" id="sj5"></div>
		<div class="sj" id="sj3"></div>
		<div class="sj" id="sj1"></div>
		<div class="sjo" id="sjg7"></div>
		<div class="sjo" id="sjg5"></div>
		<div class="sjo" id="sjg3"></div>
		<div class="sjo" id="sjg1"></div>
		<div class="sj" id="sj8"></div>
		<div class="sj" id="sj6"></div>
		<div class="sj" id="sj4"></div>
		<div class="sj" id="sj2"></div>
		<div class="sjo" id="sjg8"></div>
		<div class="sjo" id="sjg6"></div>
		<div class="sjo" id="sjg4"></div>
		<div class="sjo" id="sjg2"></div>
		<div class="nmt">성명</div>
		<div class="nm" id="nm1"></div>
		<div class="nm" id="nm2"></div>
		<div class="nm" id="nm3"></div>
		<div class="nmat">획수</div>
		<div class="nma" id="nmc1"></div>
		<div class="nma" id="nmc2"></div>
		<div class="nma" id="nmc3"></div>
		<div class="nmat">음양</div>
		<div class="nma" id="ckod1"></div>
		<div class="nma" id="ckod2"></div>
		<div class="nma" id="ckod3"></div>
		<div class="nmat">음령오행</div>
		<div class="nma" id="nms1"></div>
		<div class="nma" id="nms2"></div>
		<div class="nma" id="nms3"></div>
		<div class="nmat">원</div>
		<div class="nmx"></div>
		<div class="nma1" id="cnta1"></div>
		<div class="nmat">형</div>
		<div class="nma1" id="cnta2"></div>
		<div class="nmx"></div>
		<div class="nmat">이</div>
		<div class="nma0" id="cnta3"></div>
		<div class="nmx"></div>
		<div class="nma0"></div>
		<div class="nmat">정</div>
		<div class="nma2" id="cnta4"></div>
		<div class="nmat">곡획</div>
		<div class="nma" id="nmd1"></div>
		<div class="nma" id="nmd2"></div>
		<div class="nma" id="nmd3"></div>
		<div class="nmat">원</div>
		<div class="nmx"></div>
		<div class="nma1" id="cntb1"></div>
		<div class="nmat">형</div>
		<div class="nma1" id="cntb2"></div>
		<div class="nmx"></div>
		<div class="nmat">이</div>
		<div class="nma0" id="cntb3"></div>
		<div class="nmx"></div>
		<div class="nma0"></div>
		<div class="nmat">정</div>
		<div class="nma2" id="cntb4"></div>

	</div>
		<div id="output"></div>
</div>

<script type="text/javascript">

fread("gan");
fread("jiji");
fread("samoh");
fread("sndoh");
fread("suri");
fread("t64t");
	
function fread(fn){
    $(function (){
	var fileName = "./" + fn + ".csv";	// 파일 이름

	$.ajax({
		url:fileName,
		dataType:'text',
		success: function(da) {
			var textLine = '<script type="text/javascript">var ' + fn + '=[';
                        var rows = da.split('\n');
                        for (var i = 0; i < rows.length; i++) {
				if (i == 0){textLine += '['}else{textLine += ',['};
				var cells = rows[i].split(',');
                                for (var j = 0; j < cells.length; j++) {
					textLine += '"';
					textLine += cells[j].trim();;
					if (j == cells.length-1){textLine += '"'}else{textLine += '",'};
				}
				textLine += ']';
			}	
			textLine += ']';			
			$('head').append(textLine);
		}
	});
    });
};

</script>

<script type="text/javascript">

$( function() {
	$( 'button#clear1' ).click( function() {
		$( 'input#sj' ).val('');
		$( 'input#nm' ).val('');
		$( 'input#nm0' ).val('');
		$( 'input#sjs' ).val('');
		$( 'input#nma' ).val('');
		$( 'input#nmb' ).val('');
		$('#output').empty();
		$('.sj').empty();
		$('.sjo').empty();
		$('.nm').empty();
		$('.nma').empty();
		$('.nma0').empty();
		$('.nma1').empty();
		$('.nma2').empty();
		chg_bgcolor('.sj','#fff');
	} );
} );

function chg_bgcolor(a,b) {
	$(a).css("background-color",b);
}

function chkOdd(num) { return (num % 2)? "양":"음"; }

$( function() {
	$( 'button#submit1' ).click( function() {
		$('#output').empty();
		$('#output').append(' &nbsp; 성명: ' + name + ' &nbsp; 사주: ' + saju + ' &nbsp; 음령오행: ' + $('input#sjs').val() + ' &nbsp; 획수: ' + $('input#nma').val() + ' &nbsp; 곡획: ' + $('input#nmb').val() + '<br>');

		var sjsn = $('input#sjs').val();
		var sndh = ""; var sndt = "";
		sndo = $.map(sndoh, function(element, index) {
			if (element[0] === sjsn) {
				sndh = element[1];
				sndt = element[1] + ' __ ' + element[2] + ' __ '  + element[3];
			};
		});

		var nmcn = $('input#nma').val().split(',');
		var nmdn = $('input#nmb').val().split(',');
		nmcn1 = Number(nmcn[0]);
		nmcn2 = Number(nmcn[1]);
		nmcn3 = Number(nmcn[2]);
		nmdn1 = Number(nmdn[0]);
		nmdn2 = Number(nmdn[1]);
		nmdn3 = Number(nmdn[2]);

		cnta1 = nmcn2 + nmcn3;
		cnta2 = nmcn1 + nmcn2;
		cnta3 = nmcn1 + nmcn3;
		cnta4 = nmcn1 + nmcn2 + nmcn3;
		cntb1 = nmdn2 + nmdn3;
		cntb2 = nmdn1 + nmdn2;
		cntb3 = nmdn1 + nmdn3;
		cntb4 = nmdn1 + nmdn2 + nmdn3;

		document.getElementById('nms1').innerText =  sndh.substring(0,1);
		document.getElementById('nms2').innerText =  sndh.substring(1,2);
		document.getElementById('nms3').innerText =  sndh.substring(2,3);
		document.getElementById('nmc1').innerText =  nmcn1;
		document.getElementById('nmc2').innerText =  nmcn2;
		document.getElementById('nmc3').innerText =  nmcn3;
		document.getElementById('ckod1').innerText =  chkOdd(nmcn1);
		document.getElementById('ckod2').innerText =  chkOdd(nmcn2);
		document.getElementById('ckod3').innerText =  chkOdd(nmcn3);
		document.getElementById('nmd1').innerText =  nmdn1;
		document.getElementById('nmd2').innerText =  nmdn2;
		document.getElementById('nmd3').innerText =  nmdn3;
		document.getElementById('cnta1').innerText =  cnta1;
		document.getElementById('cnta2').innerText =  cnta2;
		document.getElementById('cnta3').innerText =  cnta3;
		document.getElementById('cnta4').innerText =  cnta4;
		document.getElementById('cntb1').innerText =  cntb1;
		document.getElementById('cntb2').innerText =  cntb2;
		document.getElementById('cntb3').innerText =  cntb3;
		document.getElementById('cntb4').innerText =  cntb4;

		$('#output').append('■■■ 음령오행 ----------------<br>');
		$('#output').append(sndt + '<br>');
		consuri();
		con64t();
		conhwng();
		conins64t();
		consamgi();
		conjin();
		consamoh();
	} );
} );

var sgan = new Array;
var sjk = ""; var sju = ""; var sjpm = ""; var sjupm = ""; var sjut = ""; 
var sjuh = ""; var saju = ""; var name = ""; var samsj1 = "";

function printSaju(){
    saju = document.getElementById('sj').value;
	for (i=0; i<4; i++){
		n = 2*i+1;
		sjk = "sj" + n;
		a = "#" + sjk;
		sjpm = "sjg" + n;
		sju = saju.substring(2*i,n);
		sgan = $.map(gan, function(element, index) {
			if (element[1] === sju) {
				sjuh = element[2];
				sjupm = element[5] + element[6];
				b = element[7];
			};
		});
		if (n==1){
			samsj1 = sjuh;
		};

	document.getElementById(sjk).innerText =  sjuh;
		document.getElementById(sjpm).innerText =  sjupm;
		chg_bgcolor(a,b);
	};

	for (j=0; j<4; j++){
		n = 2*j+2;
		sjk = "sj" + n;
		a = "#" + sjk;
		sjpm = "sjg" + n;
		sju = saju.substring(n-1,n);

		sjiji = $.map(jiji, function(element, index) {
			if (element[0] === sju) {
				sjuh = element[1];
				sjupm = element[3] + element[5];
				b = element[6];
			};
		});
		document.getElementById(sjk).innerText =  sjuh;
		document.getElementById(sjpm).innerText =  sjupm;
		chg_bgcolor(a,b);
	};
};

function printName()  {
  name = document.getElementById('nm').value;
  document.getElementById("nm1").innerText =  name.substring(0,1);
  document.getElementById("nm2").innerText =  name.substring(1,2);
  document.getElementById("nm3").innerText =  name.substring(2,3);
}

//====================수리법(원형이정)====================
function consuri(){
	$('#output').append('■■■ 수리법(원형이정) ----------------<br>');
	suria = $.map(suri, function(element, index) {
		if (element[0] === String(cnta1)) {
			t1 = '■ 원(초년운):' + element[0] + element[1] + element[2] + '<br>';
			t2 = element[3] + '<br>';
		}
	});
	$('#output').append(t1);
	$('#output').append(t2);
	surib = $.map(suri, function(element, index) {
		if (element[0] === String(cnta2)) {
			t3 = '■ 형(청년운):' + element[0] + element[1] + element[2] + '<br>';
			t4 = element[3] + '<br>';
		}
	});
	$('#output').append(t3);
	$('#output').append(t4);
	suric = $.map(suri, function(element, index) {
		if (element[0] === String(cnta3)) {
			t5 = '■ 이(장년운):' + element[0] + element[1] + element[2] + '<br>';
			t6 = element[3] + '<br>';
		}
	});
	$('#output').append(t5);
	$('#output').append(t6);
	surid = $.map(suri, function(element, index) {
		if (element[0] === String(cnta4)) {
			t7 = '■ 정(노년운):' + element[0] + element[1] + element[2] + '<br>';
			t8 = element[3] + '<br>';
		}
	});
	$('#output').append(t7);
	$('#output').append(t8);
};

//==================== 선천결 == 팔괘법(64괘) ====================
function con64t(){
	var a1 = nmcn1 % 8; if (a1 == 0){a1 = 8};
	var a2 = cnta1 % 8; if (a2 == 0){a2 = 8};
	var a0 = String(a1) + String(a2);
	$('#output').append('■■■ 선천결 == 팔괘법(64괘): ' + a0 + '--------------<br>');
	t64ta = $.map(t64t, function(element, index) {
		if (element[0] === a0) {
			t0 = element[0] + element[1] + element[2] + '<br>';
			t1 = element[3] + '<br>' + element[4] + '<br>' + element[5] + '<br>' + element[6] + '<br>' + element[7] + '<br>';
		}
	});
	$('#output').append(t0);
	$('#output').append(t1);
};

//==================== 후천결 == 황극책수 ====================
function conhwng(){
	var a1 = cntb2 % 8; if (a1 == 0){a1 = 8};
	var a2 = cntb4 % 8; if (a2 == 0){a2 = 8};
	var a3 = cntb4 % 6; if (a3 == 0){a3 = 6};
	var ccnum = 0; var hwnum = 0; var hwt = ""; var h1 = 0; var h2 = 0;

	if (a1 == 1){h1 = 30
	}else{
		if (a1 == 2 || a1 == 3 || a1 == 5){h1 = 21
		}else{
			if (a1 == 4 || a1 == 6 || a1 == 7){h1 = 12
			}else{
				if (a1 == 8){h1 = 3}}}}

	if (a2 == 1){h2 = 30
	}else{
		if (a2 == 2 || a2 == 3 || a2 == 5){h2 = 21
		}else{
			if (a2 == 4 || a2 == 6 || a2 == 7){h2 = 12
			}else{
				if (a2 == 8){h2 = 3}}}}

	hnum = h1 + h2;
	ka = parseInt(hnum / 10);
	kb = hnum % 10;

	ccnum = ka * 36 + kb *24;

	if (a3<4){
		hwnum = (a2*10 + a3) * ccnum + ccnum + a1 + a2 + a3;
	}else{
		hwnum = (a3*10 + a1) * ccnum + ccnum + a1 + a2 + a3;
	};
		hwt = String(hwnum).slice(-4);

	var a0 = String(a1) + String(a2) + '의 ' + String(a3) + '효-----元會運世--' + hwt;
	$('#output').append('■■■ 후천결 == 황극책수: ' + a0 + '--------------<br>');
};

//==================== 내부팔괘법 ====================
function conins64t(){
	$('#output').append('■■■ 내부팔괘법 ----------------<br>');
	var b1 = nmcn2 % 8; if (b1 == 0){b1 = 8};
	var b2 = nmcn3 % 8; if (b2 == 0){b2 = 8};
	var b3 = cnta1 % 6; if (b3 == 0){b3 = 6};
	var bt1 = String(b1) + String(b2) + '의 ' + String(b3) + '효';
	$('#output').append('■ 내부팔괘법(초년운): ' + bt1 + '--------------<br>');

	var b4 = nmdn2 % 6; if (b4 == 0){b4 = 6};
	var b5 = nmdn3 % 6; if (b5 == 0){b5 = 6};
	var b6 = cntb1 % 6; if (b6 == 0){b6 = 6};
	var bt2 = String(b4) + String(b5) + '의 ' + String(b6) + '효';
	$('#output').append('■ 내부팔괘법(중년운): ' + bt2 + '--------------<br>');

	var b7 = cnta4 % 8; if (b7 == 0){b7 = 8};
	var b8 = cntb4 % 6; if (b8 == 0){b8 = 6};
	var b9 = (cnta4 + cntb4) % 6; if (b9 == 0){b9 = 6};
	var bt3 = String(b7) + String(b8) + '의 ' + String(b9) + '효';
	$('#output').append('■ 내부팔괘법(말년운): ' + bt3 + '--------------<br>');
};

//==================== 삼기배합법 ====================
function consamgi(){
	var sn0 = 0; var sn1 = ""; var samgi = ""; 
	var a1 = (cnta1 + cnta2 + cnta4) % 8; if (a1 == 0){a1 = 8};
	var a0 = '생년 천간 ' + samsj1 + '으로부터 ' + String(a1) + '번째 천간의 내용 조회';
	$('#output').append('■■■ 삼기배합법: ' + a0 + '----------<br>');

	samgan1 = $.map(gan, function(element, index) {
		if (element[2] === samsj1) {
			sn0 = Number(element[0]);
		}
	});
	sn1 = String((sn0 + a1 - 1) % 10);
	samgan2 = $.map(gan, function(element, index) {
		if (element[0] === sn1) {
			samgi = element[2] + ' __ ' + element[10] + ' __ ' + element[11];
		}
	});
	$('#output').append(samgi + '<br>');
};

//==================== 진천동지결 ====================
function conjin(){
	var a1 = (nmcn1 *100 + nmcn2 *10 + nmcn3) % 144; if (a1 == 0){a1 = 144};
	$('#output').append('■■■ 진천동지결(선천): ' + String(a1) + '--조회------------<br>');
	var b1 = (nmdn1 *100 + nmdn2 *10 + nmdn3) % 144; if (b1 == 0){b1 = 144};
	$('#output').append('--- 진천동지결(후천): ' + String(b1) + '--조회------------<br>');
};

//==================== 삼원오행 ====================
	var sohan = ""; var sohn = ""; var soha1 = ""; var soha2 = ""; var soha3 = "";
function consamoh(){
	$('#output').append('■■■ 삼원오행 ----------------<br>');
	var aa = new Array; var bb = new Array; var k = "";
		//-----계산법(1)---
	a1 = String(cnta3 % 10);	
	a2 = String(cnta2 % 10);	
	a3 = String(cnta1 % 10);	
		//-----계산법(2)---
	b1 = String(nmcn1 % 10);	
		//-----계산법(3)---
	c1 = String((nmcn1+1) % 10);	
		//-----계산법(4)---
	d1 = String(nmcn1 % 10);	
	d2 = String(nmcn2 % 10);	
	d3 = String(nmcn3 % 10);

	aa = [a1,a2,a3,b1,c1,d1,d2,d3];

	for (i=0; i<aa.length; i++){
		smgan = $.map(gan, function(element, index) {
			if (element[0] === aa[i]) {
				var so = element[3].substring(2,3);
				bb.push(so);
			};
		});
	};

	for (i=0; i<4; i++){
		var smo = "";
		k = String(i+1);
		if (i==0){sohn = bb[0] + bb[1] + bb[2]};
		if (i==1){sohn = bb[3] + bb[1] + bb[2]};
		if (i==2){sohn = bb[4] + bb[1] + bb[2]};
		if (i==3){sohn = bb[5] + bb[6] + bb[7]};

		smoh = $.map(samoh, function(element, index) {
			if (element[0] === sohn) {
				smo = element[1] + ' __ ' + element[2] + '<br/> __ ' +  element[3];
			};
		});
		$('#output').append('■ 계산법('+ k +'): ' + sohn + '--');
		$('#output').append(smo + '<br>');
	};
};

 </script>
 </body>
</html>
